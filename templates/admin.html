<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quizify/Admin</title>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/adminstyles.css') }}">


</head>
<body>
    <div id="large-header" class="large-header">
        <canvas id="demo-canvas"></canvas>
        <br>
        <br>
        <form method="post">
          <input type="text" name="userName" placeholder="Your Name" required>
          <input type="submit" value="Submit">
        </form>
    <div class="text-container">
      <h1>Players Joined</h1>
      <br>
      <br>
<div id="users-container">
    {% for user in all_users %}
       <span class="user">{{ user }}</span>
    {% endfor %}
</div>

        <h2 style="color: orange;">Code: {{ code }}</h2>
        <div>
        <form action="/copy_code" method="post">
            <button type="submit" class="adminbtn" name="copy_code" onclick="copyToClipboard('{{ code }}')">Copy Code</button>
        </form>
        <form action="{{ url_for('share_on_whatsapp') }}" method="post">
            <input type="hidden" name="code" value="{{ code }}">
            <button type="submit"class="adminbtn">Share on WhatsApp</button>
        </form>
    </div>
    </div>
    <br>
    <br>
    <form action="{{ url_for('gg') }}" method="post">
      <input type="submit" class="adminstartbtn" value="Start Game">
    </form>
    </div>
  
  <script>
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(function() {
            alert("Code copied successfully!");
        }, function(err) {
            console.error('Could not copy text: ', err);
        });
    }
  </script> 
  <script>
    // Reload the page every second
    setInterval(function () {
        location.reload();
    }, 10000);
</script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <!-- Add Firebase scripts
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>

    <script>
      firebase.initializeApp({
        apiKey: "AIzaSyCKqR9wTb5eFBoQ8hULyaqFjaggDHMe1uM",
        authDomain: "quizapp-e74fe.firebaseapp.com",
        projectId: "quizapp-e74fe",
        storageBucket: "quizapp-e74fe.appspot.com",
        messagingSenderId: "1098236969903",
        appId: "1:1098236969903:web:814566823b75fe2557a55a",
        measurementId: "G-31DZJS4FLZ"
      });
      
      const messaging = firebase.messaging();
  
      messaging.getToken({ vapidKey: "BINsnNekz_2ZB_5VDUgTyhf5VwM5wdUSmd4OmTur4ndtMxY8HLyl2EmCmE-ODymK22edqOsZ9GyVY8XKw1tAqsQ" }).then((currentToken) => {
          if (currentToken) {
              console.log('Device token:', currentToken);
              document.getElementById('device-token').value = currentToken;
          } else {
              console.log('No registration token available. Request permission to generate one.');
          }
      }).catch((err) => {
          console.log('An error occurred while retrieving token:', err);
      });
      Notification.requestPermission().then((permission) => {
  console.log('Permission status:', permission);
});
      function copyToClipboard(text) {
          const el = document.createElement('textarea');
          el.value = text;
          document.body.appendChild(el);
          el.select();
          document.execCommand('copy');
          document.body.removeChild(el);
          alert('Code copied to clipboard!');
      }

      // Get the form element
      // Get the form element
const form = document.querySelector('form[data-action]');

// Add a submit event listener to the form
form.addEventListener('submit', (event) => {
  // Prevent the default form submission
  event.preventDefault();

  // Get the form data
  const formData = new FormData(form);

  // Convert the form data to a JSON object
  const jsonData = Object.fromEntries(formData.entries());

  // Send the JSON data with the Content-Type header set to application/json
fetch(form.dataset.action, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(jsonData)
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => {
  console.error('Error:', error);
  alert('An error occurred while sending the notification. Please try again later.');
});
}
);
  </script> -->

  </body>
</html>